import{d as H,r as _,o as z,J as ae,v as L,K as F,i as s,t as h,L as V,A as o,z as n,x as t,y as x,M as p,B as f,N as U,O as ne,P as oe,_ as q,j as Y,Q as se,R as le}from"./wxwYPe_f.js";import{u as re}from"./D9v75QF5.js";const ie=Symbol.for("nuxt:client-only"),ce=H({name:"ClientOnly",inheritAttrs:!1,props:["fallback","placeholder","placeholderTag","fallbackTag"],setup(G,{slots:m,attrs:N}){const b=_(!1);return z(()=>{b.value=!0}),ae(ie,!0),g=>{var k;if(b.value)return(k=m.default)==null?void 0:k.call(m);const u=m.fallback||m.placeholder;if(u)return u();const v=g.fallback||g.placeholder||"",y=g.fallbackTag||g.placeholderTag||"span";return L(y,N,v)}}}),de={class:"d-flex align-center justify-space-between mb-3"},ue={class:"text-caption text-medium-emphasis"},pe={class:"d-flex align-center justify-space-between mb-2"},me={class:"text-caption text-medium-emphasis"},ve={class:"d-flex align-center flex-wrap gap-2 mb-2"},fe={class:"text-subtitle-1 font-weight-bold"},_e={class:"d-flex align-center flex-wrap gap-2 mb-2"},ge={class:"text-subtitle-1 font-weight-bold"},ye={class:"d-flex align-center flex-wrap gap-2 mb-2"},we={class:"text-subtitle-1 font-weight-bold"},he={class:"d-flex align-center flex-wrap gap-2 mb-2"},xe={class:"text-body-2"},be={class:"mb-2"},ke={class:"d-flex flex-wrap gap-2 mt-3"},Se={class:"d-flex justify-end"},Ne="https://docs.google.com/spreadsheets/d/e/2PACX-1vRgNPBOEVtc997aMMVBvOSdYjVUDZwXL6RwU2PLWsKkmOo6G2HZ12JlicNkv0fqg8deOo4rDLKL1Jr0/pub?gid=2137698376&single=true&output=csv",D="https://script.google.com/macros/s/AKfycbwu3KGq6KRcDmx7DJy4ZI3x2FYwu4Kq2V2l3q5kyiFJthTyuQWdhosBGZyo15KBw8NYyQ/exec",J="wV1a4cHq2t1AxKHNCPCXiNNLBtNsSSx6",Ce=H({__name:"CMainPage",setup(G){const m=_(new Set);function N(a){return String(a??"").replace(/^\uFEFF/,"").replace(/^"|"$/g,"").trim().replace(/[ï¼â€“â€”]/g,"-")}async function b(){try{const e=(await fetch(Ne,{cache:"no-store"}).then(r=>r.text())).split(/\r?\n/).map(r=>N(r.split(",")[0])).filter(Boolean);m.value=new Set(e),console.log("bank csv sample:",e.slice(0,20)),console.log("has 2-4-9?",m.value.has("2-4-9"))}catch(a){console.error("è®€å–éŠ€è¡Œé ç®—æ¸…å–®å¤±æ•—",a),m.value=new Set}}function g(a){const e=N(a);return e&&m.value.has(e)?"å¯Œé‚¦":"è¯å—"}const u=_([]),v=_(!1),y=_(""),k=_(!1),w=F({}),S=_(null),C=F({show:!1,text:""});function P(a){C.text=a,C.show=!0}async function j(a){const e=await $fetch(a,{method:"GET"});if(typeof e=="string")try{return JSON.parse(e)}catch{throw new Error(`GAS å›å‚³é JSONï¼š${e.slice(0,200)}`)}return e}async function $(){v.value=!0,y.value="";try{const a=new URL(D);a.searchParams.set("action","pending"),a.searchParams.set("key",J);const e=await j(a.toString());if((e==null?void 0:e.error)==="Unauthorized")throw new Error("æœªæˆæ¬Šï¼šè«‹ç¢ºèª gasKey æ˜¯å¦æ­£ç¢ºã€ä¸”å·²è¢«æ‰“åŒ…é€²å‰ç«¯ï¼ˆNUXT_PUBLIC_...ï¼‰");if(!Array.isArray(e))throw console.error("pending response unexpected:",e),new Error(`GAS å›å‚³æ ¼å¼éŒ¯èª¤ï¼š${JSON.stringify(e).slice(0,200)}`);u.value=e;for(const r of u.value)w[r.row]===void 0&&(w[r.row]="")}catch(a){y.value=(a==null?void 0:a.message)||"è¼‰å…¥å¤±æ•—",u.value=[]}finally{v.value=!1,k.value=!0}}function B(a){const e=String(a??"").trim();if(!e)return"";const r=e.replace(/\s+/g," ").trim();{const i=r.match(/éŠ€è¡Œä»£ç¢¼\s*[0-9]{3}\s*([0-9][0-9\- ]{5,})/i);if(i)return i[1].replace(/[^0-9]/g,"")}{const i=r.match(/\(?\s*[0-9]{3}\s*\)?\s*[-)]\s*([0-9][0-9\- ]{5,})/);if(i)return i[1].replace(/[^0-9]/g,"")}{const i=r.match(/[0-9]{3}\s*[-â€“â€”]\s*([0-9][0-9\- ]{5,})/);if(i)return i[1].replace(/[^0-9]/g,"")}const c=r.replace(/[^0-9]/g,"");return c.length>=8?c:""}async function l(a){const e=B(a);if(!e){P("é€™ç­†ä»˜æ¬¾è³‡è¨Šæ²’æœ‰å¯è¤‡è£½çš„ã€Œå¸³è™Ÿã€");return}try{await navigator.clipboard.writeText(e),P(`å·²è¤‡è£½å¸³è™Ÿï¼š${e}`)}catch{P("è¤‡è£½å¤±æ•—ï¼ˆç€è¦½å™¨é™åˆ¶ï¼‰")}}async function M(a){const e=(w[a]??"").toString().trim();if(e===""){P("è«‹å…ˆå¡«å¯«æ‰‹çºŒè²»ï¼ˆå¯å¡« 0ï¼‰");return}const r=Number(e);if(Number.isNaN(r)||r<0){P("æ‰‹çºŒè²»éœ€ç‚º 0 ä»¥ä¸Šçš„æ•¸å­—");return}S.value=a;try{const c=new URL(D);c.searchParams.set("action","markPaid"),c.searchParams.set("row",String(a)),c.searchParams.set("fee",String(r)),c.searchParams.set("key",J);const i=await $fetch(c.toString(),{method:"GET"});if(!(i!=null&&i.success))throw new Error(`æ¨™è¨˜å¤±æ•—ï¼š${JSON.stringify(i).slice(0,200)}`);P(`Row ${a} å·²æ¨™è¨˜åŒ¯æ¬¾`),await $()}catch(c){P((c==null?void 0:c.message)||"æ¨™è¨˜å¤±æ•—")}finally{S.value=null}}return console.log("GAS_BASE_URL",D),console.log("GAS_KEY length",J.length),z(async()=>{await b(),await $()}),(a,e)=>{const r=s("v-btn"),c=s("v-alert"),i=s("v-skeleton-loader"),A=s("v-chip"),E=s("v-divider"),O=s("v-textarea"),T=s("v-text-field"),X=s("v-card-text"),Z=s("v-card"),Q=s("v-snackbar"),W=s("v-container"),ee=s("v-main"),te=s("v-app");return h(),V(te,null,{default:o(()=>[n(ee,null,{default:o(()=>[n(W,{class:"py-4",style:{"max-width":"720px"}},{default:o(()=>[t("div",de,[t("div",null,[e[1]||(e[1]=t("div",{class:"text-h6 font-weight-bold"},"å‡ºç´åŒ¯æ¬¾æ¸…å–®",-1)),t("div",ue," å¾…åŒ¯æ¬¾ï¼š"+x(p(u).length)+" ç­† ",1)]),n(r,{variant:"tonal","prepend-icon":"mdi-refresh",loading:p(v),onClick:$},{default:o(()=>e[2]||(e[2]=[f(" é‡æ–°æ•´ç† ")])),_:1},8,["loading"])]),p(y)?(h(),V(c,{key:0,type:"error",variant:"tonal",class:"mb-3"},{default:o(()=>[f(x(p(y)),1)]),_:1})):U("",!0),p(v)&&!p(k)?(h(),V(i,{key:1,type:"card, card, card",class:"mb-4"})):p(k)&&!p(u).length?(h(),V(c,{key:2,type:"success",variant:"tonal"},{default:o(()=>e[3]||(e[3]=[f(" ç›®å‰æ²’æœ‰å¾…åŒ¯æ¬¾é …ç›® ğŸ‰ ")])),_:1})):U("",!0),(h(!0),L(ne,null,oe(p(u),d=>(h(),V(Z,{key:d.row,class:"mb-3",rounded:"md",elevation:"3"},{default:o(()=>[n(X,{class:"pa-4"},{default:o(()=>[t("div",pe,[n(A,{color:"primary",class:"amount-chip"},{default:o(()=>[f(" NT$ "+x(d.amount),1)]),_:2},1024),t("div",me," Row "+x(d.row),1)]),t("div",ve,[e[4]||(e[4]=t("div",{class:"text-caption text-medium-emphasis"},"ä»˜æ¬¾å°è±¡",-1)),t("div",fe,x(d.payee||"ï¼ˆä»˜æ¬¾å°è±¡ç©ºï¼‰"),1)]),t("div",_e,[e[5]||(e[5]=t("div",{class:"text-caption text-medium-emphasis"},"ç”³è«‹äºº",-1)),t("div",ge,x(d.applicant||"ï¼ˆä»˜æ¬¾å°è±¡ç©ºï¼‰"),1)]),t("div",ye,[e[6]||(e[6]=t("div",{class:"text-caption text-medium-emphasis"},"é ç®—ç·¨è™Ÿ",-1)),t("div",we,x(d.budgetCode||"ï¼ˆç©ºï¼‰"),1),n(A,{size:"small",variant:"tonal",class:"text-subtitle-2 font-weight-bold",color:g(d.budgetCode)==="å¯Œé‚¦"?"blue":"red"},{default:o(()=>[f(x(g(d.budgetCode)),1)]),_:2},1032,["color"])]),t("div",he,[e[7]||(e[7]=t("div",{class:"text-caption text-medium-emphasis"},"ç”¨é€”",-1)),t("div",xe,x(d.purpose||"ï¼ˆä»˜æ¬¾å°è±¡ç©ºï¼‰"),1)]),n(E,{class:"my-3"}),t("div",be,[e[8]||(e[8]=t("div",{class:"text-caption text-medium-emphasis mb-1"},"ä»˜æ¬¾è³‡è¨Š",-1)),n(O,{"model-value":d.payInfo,readonly:"","auto-grow":"",rows:"1",variant:"outlined",density:"compact","hide-details":""},null,8,["model-value"])]),t("div",ke,[n(r,{variant:"tonal","prepend-icon":"mdi-content-copy",class:"btn-copy",onClick:R=>l(d.payInfo)},{default:o(()=>e[9]||(e[9]=[f(" è¤‡è£½ä»˜æ¬¾å¸³è™Ÿ ")])),_:2},1032,["onClick"]),n(T,{modelValue:p(w)[d.row],"onUpdate:modelValue":R=>p(w)[d.row]=R,type:"number",inputmode:"numeric",label:"æ‰‹çºŒè²»",variant:"outlined",density:"compact",class:"fee-input","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),n(E,{class:"my-4"}),t("div",Se,[n(r,{color:"primary",variant:"flat",size:"large",class:"btn-paid",loading:p(S)===d.row,disabled:p(S)!==null,"prepend-icon":"mdi-check",onClick:R=>M(d.row)},{default:o(()=>e[10]||(e[10]=[f(" å·²åŒ¯æ¬¾ ")])),_:2},1032,["loading","disabled","onClick"])])]),_:2},1024)]),_:2},1024))),128)),n(Q,{modelValue:p(C).show,"onUpdate:modelValue":e[0]||(e[0]=d=>p(C).show=d),timeout:1600},{default:o(()=>[f(x(p(C).text),1)]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})}}}),Pe=q(Ce,[["__scopeId","data-v-66aaea19"]]),Be={key:0,class:"gate-wrap"},Te={class:"d-flex align-center justify-center"},Ve={key:1,class:"gate-wrap"},Le={class:"d-flex align-center justify-space-between mb-4"},$e={class:"d-flex flex-wrap gap-2 mt-2"},Ge={class:"d-flex align-center justify-space-between mt-4"},je={key:2},Ae={class:"pinbar"},Ee=H({__name:"PinGate",props:{pin:{},storageKey:{}},setup(G){const m=G,N=Y(()=>String(m.pin??"0919")),b=Y(()=>m.storageKey??"cashier_pin_ok"),g=_(!1),u=_(!1),v=_(""),y=_(!1),k=_(!0),w=_(""),S=_({show:!1,text:""});function C(B){S.value.text=B,S.value.show=!0}function P(){v.value="",w.value=""}function j(){w.value="";const B=String(v.value??"").trim();if(!B){w.value="è«‹è¼¸å…¥ PIN ç¢¼";return}if(B!==N.value){w.value="PIN ç¢¼éŒ¯èª¤",C("PIN ç¢¼éŒ¯èª¤");return}if(u.value=!0,C("å·²è§£é–"),k.value)try{localStorage.setItem(b.value,"1")}catch{}}function $(){u.value=!1,v.value="",w.value="",C("å·²é–å®š");try{localStorage.removeItem(b.value)}catch{}}return z(()=>{try{localStorage.getItem(b.value)==="1"&&(u.value=!0)}catch{}g.value=!0}),(B,l)=>{const M=s("v-progress-circular"),a=s("v-container"),e=s("v-chip"),r=s("v-alert"),c=s("v-text-field"),i=s("v-btn"),A=s("v-checkbox"),E=s("v-card"),O=s("v-snackbar");return h(),L("div",null,[g.value?u.value?(h(),L("div",je,[t("div",Ae,[n(i,{variant:"tonal",color:"red",size:"small","prepend-icon":"mdi-lock",onClick:$},{default:o(()=>l[9]||(l[9]=[f(" ç™»å‡º ")])),_:1})]),le(B.$slots,"default",{},void 0)])):(h(),L("div",Ve,[n(a,{class:"py-10",style:{"max-width":"520px"}},{default:o(()=>[n(E,{rounded:"lg",class:"pa-4",elevation:"0"},{default:o(()=>[t("div",Le,[l[6]||(l[6]=t("div",null,[t("div",{class:"text-h6 font-weight-bold"},"å®‰å…¨æ€§é©—è­‰"),t("div",{class:"text-caption text-medium-emphasis"},"è«‹è¼¸å…¥ PIN ç¢¼æ–¹å¯æŸ¥é–±")],-1)),n(e,{size:"small",variant:"tonal"},{default:o(()=>l[5]||(l[5]=[f("åƒ…ä¾›å…§éƒ¨ä½¿ç”¨")])),_:1})]),w.value?(h(),V(r,{key:0,type:"error",variant:"tonal",class:"mb-3"},{default:o(()=>[f(x(w.value),1)]),_:1})):U("",!0),n(c,{modelValue:v.value,"onUpdate:modelValue":l[0]||(l[0]=T=>v.value=T),type:y.value?"text":"password",label:"PIN ç¢¼",inputmode:"numeric",autocomplete:"one-time-code",maxlength:"10",variant:"outlined",density:"comfortable",onKeyup:se(j,["enter"]),"append-inner-icon":y.value?"mdi-eye-off":"mdi-eye","onClick:appendInner":l[1]||(l[1]=T=>y.value=!y.value)},null,8,["modelValue","type","append-inner-icon"]),t("div",$e,[n(i,{color:"primary",variant:"flat",class:"flex-grow-1",onClick:j},{default:o(()=>l[7]||(l[7]=[f(" é€²å…¥ ")])),_:1}),n(i,{variant:"tonal",onClick:P},{default:o(()=>l[8]||(l[8]=[f(" æ¸…é™¤ ")])),_:1})]),t("div",Ge,[n(A,{modelValue:k.value,"onUpdate:modelValue":l[2]||(l[2]=T=>k.value=T),density:"compact","hide-details":"",label:"è¨˜ä½æœ¬è£ç½®"},null,8,["modelValue"])])]),_:1})]),_:1})])):(h(),L("div",Be,[g.value?U("",!0):(h(),V(a,{key:0,class:"py-10",style:{"max-width":"520px"}},{default:o(()=>[t("div",Te,[n(M,{indeterminate:""}),l[4]||(l[4]=t("div",{class:"text-body-2 text-medium-emphasis ms-3"},"è¼‰å…¥ä¸­â€¦",-1))])]),_:1}))])),n(O,{modelValue:S.value.show,"onUpdate:modelValue":l[3]||(l[3]=T=>S.value.show=T),timeout:1600},{default:o(()=>[f(x(S.value.text),1)]),_:1},8,["modelValue"])])}}}),Ie=q(Ee,[["__scopeId","data-v-cd0e2900"]]),Ke={class:"d-flex align-center justify-center"},I="å‡ºç´åŒ¯æ¬¾æ¸…å–® | å¤¢æƒ³ä¹‹éƒ½å·¥ä½œå®¤",K="åƒ…ä¾›å…§éƒ¨ä½¿ç”¨",Oe={__name:"cashier",setup(G){return re({title:I,meta:[{name:"description",content:K},{property:"og:title",content:I},{itemprop:"name",content:I},{property:"twitter:meta_title",content:I},{property:"og:description",content:K},{itemprop:"description",content:K},{property:"twitter:description",content:K},{property:"og:locale",content:"zh_TW"}],link:[{rel:"icon",href:"https://www.dreamcity.studio/images/logo.ico"},{rel:"stylesheet",href:"https://fonts.googleapis.com/css2?family=Noto+Serif+TC&family=Roboto+Mono&family=DotGothic16&family=IBM+Plex+Sans+JP:wght@400;700&display=swap"}],script:[{hid:"gtm",innerHTML:`(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-KNFPB22');`,type:"text/javascript",charset:"utf-8"},{async:!0,src:"https://www.googletagmanager.com/gtag/js?id=G-10J4H088NL"},{hid:"gtag",innerHTML:`window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-10J4H088NL');`,type:"text/javascript",charset:"utf-8"}],__dangerouslyDisableSanitizersByTagID:{gtm:["innerHTML"],gtag:["innerHTML"]}}),(m,N)=>{const b=s("v-progress-circular"),g=s("v-container"),u=ce,v=s("v-main"),y=s("v-app");return h(),V(y,null,{default:o(()=>[n(v,null,{default:o(()=>[n(u,null,{fallback:o(()=>[n(g,{class:"py-10",style:{"max-width":"520px"}},{default:o(()=>[t("div",Ke,[n(b,{indeterminate:""}),N[0]||(N[0]=t("div",{class:"text-body-2 text-medium-emphasis ms-3"},"è¼‰å…¥ä¸­â€¦",-1))])]),_:1})]),default:o(()=>[n(Ie,{pin:"0919","storage-key":"cashier_pin_ok"},{default:o(()=>[n(Pe)]),_:1})]),_:1})]),_:1})]),_:1})}}};export{Oe as default};
