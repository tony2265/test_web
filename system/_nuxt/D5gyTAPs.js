import{u as re}from"./D9v75QF5.js";import{d as ie,r as P,K as de,j as C,o as pe,F as H,i as r,t as d,L as f,A as s,z as i,x as p,y as m,M as e,B as g,N,v as _,O as U,P as z,_ as ue}from"./wxwYPe_f.js";const ce={class:"d-flex align-center justify-space-between mb-4"},me={class:"text-caption text-medium-emphasis ml-1"},ye={class:"text-subtitle-1 font-weight-bold mb-2"},fe={key:0,class:"text-caption text-medium-emphasis mb-4"},ve={key:6,class:"text-body-2 text-error"},ge={key:7,class:"mt-4"},_e={key:8,class:"mt-4"},be={class:"text-body-2"},he={class:"text-medium-emphasis force-blue"},we={class:"text-body-1 force-black"},ke="https://docs.google.com/spreadsheets/d/e/2PACX-1vSPtAuRUBtpdVohSDJUwngzRjUPMSqsgOR7RsQv0rI0oanUlC-r7tCNIpJjk6J4b2oalBfuvzoh50PS/pub?gid=0&single=true&output=csv",xe="https://docs.google.com/spreadsheets/d/e/2PACX-1vSPtAuRUBtpdVohSDJUwngzRjUPMSqsgOR7RsQv0rI0oanUlC-r7tCNIpJjk6J4b2oalBfuvzoh50PS/pub?gid=691371121&single=true&output=csv",Se="https://docs.google.com/forms/d/e/1FAIpQLSdoS2XM0vSaExwlJYa_Yo5RtWUoGJqPt3HO7T4fWkQjNSYfAQ/viewform",Pe=ie({__name:"MainPage",setup(F){const v={applicant:"entry.227203665",budgetCode:"entry.798019421",amount:"entry.781561663",purpose:"entry.911688229",payee:"entry.1906095594",payMethod:"entry.93780387",payInfo:"entry.627391982",payProof:"entry.1651297620"},b=P([{key:"applicant",label:"申請人",type:"select",options:["嗡嗡","Nick","CB"],entry:v.applicant},{key:"budgetName",label:"預算名稱",type:"select",source:"budgets",hint:"選名稱後會自動帶入「預算編號」"},{key:"amount",label:"金額",type:"number",entry:v.amount,placeholder:"例如：4000"},{key:"purpose",label:"用途",type:"text",entry:v.purpose,placeholder:""},{key:"payee",label:"付款對象",type:"select",source:"payees",entry:v.payee,hint:"可從清單選擇，或直接輸入自訂名稱（仍可手動修改）"},{key:"payMethod",label:"付款方式",type:"select",options:["匯款","現金","代墊"],entry:v.payMethod},{key:"payInfo",label:"付款資訊",type:"text",entry:v.payInfo,placeholder:"(銀行代碼) 匯款帳號"},{key:"payProof",label:"付款憑證",type:"select",options:["勞報單","電子發票","紙本發票(發票機統一發票、二聯/三聯式發票)","收據、免用統一發票收據","無須付款憑證(米畫師)","無須付款憑證(Steam)","無須付款憑證(NYCU)","無須付款憑證(其他，需於申請時補充於頻道)"],entry:v.payProof}]),o=de({applicant:"",budgetName:"",budgetCode:"",amount:"",purpose:"",payee:"",payMethod:"",payInfo:"",payProof:""}),y=P(0),w=C(()=>y.value===b.value.length),n=C(()=>b.value[y.value]),G=C(()=>Math.round(y.value/b.value.length*100)),R=P(!1),B=P([]),M=P([]);function D(a){const t=a.split(/\r?\n/).map(l=>l.trim()).filter(Boolean);if(t.length<2)return[];const u=t[0].split(",").map(l=>l.trim());return t.slice(1).map(l=>{const L=l.split(",").map(x=>x.trim()),k={};return u.forEach((x,S)=>k[x]=L[S]??""),k})}async function Y(){R.value=!0;try{const[a,t]=await Promise.all([fetch(ke).then(l=>l.text()),fetch(xe).then(l=>l.text())]),u=D(a),h=D(t);B.value=u.filter(l=>l.name).map(l=>({name:l.name,code:l.code})),M.value=h.filter(l=>l.name).map(l=>({name:l.name,method:l.method??"",info:l.info??"",proof:l.proof??""}))}finally{R.value=!1}}pe(()=>{Y().catch(console.error)}),H(()=>o.budgetName,a=>{if(!a){o.budgetCode="";return}const t=B.value.find(u=>u.name===a);t&&(o.budgetCode=t.code||"")}),H(()=>o.payee,a=>{if(!a){o.payMethod="",o.payInfo="",o.payProof="";return}const t=M.value.find(u=>u.name===a);if(!t){o.payMethod="",o.payInfo="",o.payProof="";return}o.payMethod=t.method||"",o.payInfo=t.info||"",o.payProof=t.proof||""});const $=C(()=>o.payee?M.value.some(a=>a.name===o.payee):!1);function A(a){return a.options?a.options:a.source==="budgets"?B.value.map(t=>t.name):a.source==="payees"?M.value.map(t=>t.name):[]}function O(){y.value<b.value.length&&(y.value+=1)}function Q(){y.value>0&&(y.value-=1)}const q=C(()=>[{cols:[{label:"申請人",value:o.applicant}]},{cols:[{label:"預算編號",value:o.budgetName}]},{cols:[{label:"金額",value:o.amount}]},{cols:[{label:"用途",value:o.purpose}]},{cols:[{label:"付款對象",value:o.payee}]},{cols:[{label:"付款方式",value:o.payMethod},{label:"付款資訊",value:o.payInfo}]},{cols:[{label:"付款憑證",value:o.payProof}]}]);function W(){const a=new URLSearchParams;a.set("usp","pp_url");const t=(o.budgetCode??"").trim();t&&a.set(v.budgetCode,t);for(const u of b.value){if(!u.entry||u.key==="budgetCode")continue;const h=(o[u.key]??"").trim();h&&a.set(u.entry,h)}return`${Se}?${a.toString()}`}function X(){const a=W();window.open(a,"_blank")}return(a,t)=>{const u=r("v-chip"),h=r("v-progress-linear"),l=r("v-combobox"),L=r("v-select"),k=r("v-text-field"),x=r("v-textarea"),S=r("v-alert"),V=r("v-col"),T=r("v-row"),K=r("v-list-item"),Z=r("v-list"),ee=r("v-card"),J=r("v-btn"),te=r("v-footer"),oe=r("v-container"),ne=r("v-main"),ae=r("v-app");return d(),f(ae,null,{default:s(()=>[i(ne,null,{default:s(()=>[i(T,{class:"fill-height",align:"center",justify:"center","no-gutters":""},{default:s(()=>[i(V,{cols:"12",sm:"10",md:"8",lg:"6"},{default:s(()=>[i(oe,{class:"py-6"},{default:s(()=>[p("div",ce,[p("div",null,[t[6]||(t[6]=p("div",{class:"text-h6 font-weight-bold"},"出帳表單 / DreamCity",-1)),p("div",me,m(e(y)+1)+" / "+m(e(b).length+1),1)]),e(w)?(d(),f(u,{key:0,color:"primary",variant:"flat"},{default:s(()=>t[7]||(t[7]=[g(" 已完成 ")])),_:1})):N("",!0)]),i(h,{"model-value":e(G),height:"8",rounded:"",color:"primary","bg-color":"primary-lighten-4",class:"mb-4"},null,8,["model-value"]),i(ee,{rounded:"md",class:"pa-0 elevation-0"},{default:s(()=>[e(w)?(d(),_(U,{key:1},[i(Z,{density:"compact",class:"elevation-2 ma-1"},{default:s(()=>[(d(!0),_(U,null,z(e(q),(c,le)=>(d(),f(K,{key:le},{default:s(()=>[i(T,{dense:""},{default:s(()=>[(d(!0),_(U,null,z(c.cols,(E,se)=>(d(),f(V,{key:se,cols:"12"},{default:s(()=>[p("div",be,[p("span",he,m(E.label),1)]),p("div",we,m(E.value||"（空）"),1)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024))),128))]),_:1}),i(S,{class:"mt-4",variant:"tonal",type:"warning",density:"compact"},{default:s(()=>t[16]||(t[16]=[g(" 確認內容無誤，生成後，請在 Google 表單按下「送出」方可完成申請。 ")])),_:1})],64)):(d(),_(U,{key:0},[p("div",ye,m(e(n).label),1),e(n).hint?(d(),_("div",fe,m(e(n).hint),1)):N("",!0),e(n).key==="payee"?(d(),f(l,{key:1,modelValue:e(o).payee,"onUpdate:modelValue":t[0]||(t[0]=c=>e(o).payee=c),items:A(e(n)),placeholder:"選擇或自行輸入付款對象",variant:"outlined",density:"comfortable","hide-details":"auto"},null,8,["modelValue","items"])):e(n).type==="select"?(d(),f(L,{key:2,items:A(e(n)),modelValue:e(o)[e(n).key],"onUpdate:modelValue":t[1]||(t[1]=c=>e(o)[e(n).key]=c),placeholder:e(n).placeholder||"請選擇",disabled:e(n).disabled,loading:e(n).source?e(R):!1,variant:"outlined",density:"comfortable","hide-details":"auto"},null,8,["items","modelValue","placeholder","disabled","loading"])):e(n).type==="text"?(d(),f(k,{key:3,modelValue:e(o)[e(n).key],"onUpdate:modelValue":t[2]||(t[2]=c=>e(o)[e(n).key]=c),placeholder:e(n).placeholder||"請輸入",readonly:e(n).readonly,disabled:e(n).disabled,variant:"outlined",density:"comfortable","hide-details":"auto"},null,8,["modelValue","placeholder","readonly","disabled"])):e(n).type==="number"?(d(),f(k,{key:4,modelValue:e(o)[e(n).key],"onUpdate:modelValue":t[3]||(t[3]=c=>e(o)[e(n).key]=c),type:"number",inputmode:"numeric",placeholder:e(n).placeholder||"請輸入數字",variant:"outlined",density:"comfortable","hide-details":"auto"},null,8,["modelValue","placeholder"])):e(n).type==="textarea"?(d(),f(x,{key:5,modelValue:e(o)[e(n).key],"onUpdate:modelValue":t[4]||(t[4]=c=>e(o)[e(n).key]=c),placeholder:e(n).placeholder||"請輸入",variant:"outlined",density:"comfortable",rows:"3","auto-grow":"","hide-details":"auto"},null,8,["modelValue","placeholder"])):(d(),_("div",ve," 未支援的輸入類型："+m(e(n).type),1)),e(n).key==="budgetName"&&e(o).budgetCode?(d(),_("div",ge,[i(S,{variant:"tonal",type:"info",density:"compact"},{default:s(()=>[t[8]||(t[8]=g(" 已自動帶入「預算編號」：")),p("b",null,m(e(o).budgetCode),1)]),_:1})])):N("",!0),e(n).key==="payee"&&e($)?(d(),_("div",_e,[i(S,{variant:"tonal",type:"info",density:"compact"},{default:s(()=>[t[9]||(t[9]=g(" 已自動帶入：")),t[10]||(t[10]=p("br",null,null,-1)),t[11]||(t[11]=g(" 付款方式：")),p("b",null,m(e(o).payMethod||"（空）"),1),t[12]||(t[12]=p("br",null,null,-1)),t[13]||(t[13]=g(" 付款資訊：")),p("b",null,m(e(o).payInfo||"（空）"),1),t[14]||(t[14]=p("br",null,null,-1)),t[15]||(t[15]=g(" 付款憑證：")),p("b",null,m(e(o).payProof||"（空）"),1)]),_:1})])):N("",!0)],64))]),_:1}),i(te,{app:"",elevation:"6",class:"pa-0"},{default:s(()=>[i(T,{"no-gutters":"",class:"w-100"},{default:s(()=>[i(V,{cols:"3"},{default:s(()=>[i(J,{block:"",height:a.$vuetify.display.smAndDown?72:56,variant:"tonal",class:"rounded-0",disabled:e(y)===0,icon:"mdi-chevron-left",onClick:Q},null,8,["height","disabled"])]),_:1}),i(V,{cols:"9"},{default:s(()=>[i(J,{block:"",height:a.$vuetify.display.smAndDown?72:56,color:"primary",variant:"flat",class:"rounded-0 text-h6 font-weight-medium","append-icon":e(w)?"mdi-open-in-new":"mdi-chevron-right",onClick:t[5]||(t[5]=c=>e(w)?X():O())},{default:s(()=>[g(m(e(w)?"生成並開啟表單":"下一步"),1)]),_:1},8,["height","append-icon"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}}),Ce=ue(Pe,[["__scopeId","data-v-10c478db"]]),j="出帳表單 | 夢想之都工作室",I="僅供內部使用",Ne={__name:"out",setup(F){return re({title:j,meta:[{name:"description",content:I},{property:"og:title",content:j},{itemprop:"name",content:j},{property:"twitter:meta_title",content:j},{property:"og:description",content:I},{itemprop:"description",content:I},{property:"twitter:description",content:I},{property:"og:locale",content:"zh_TW"}],link:[{rel:"icon",href:"https://www.dreamcity.studio/images/logo.ico"},{rel:"stylesheet",href:"https://fonts.googleapis.com/css2?family=Noto+Serif+TC&family=Roboto+Mono&family=DotGothic16&family=IBM+Plex+Sans+JP:wght@400;700&display=swap"}],script:[{hid:"gtm",innerHTML:`(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-KNFPB22');`,type:"text/javascript",charset:"utf-8"},{async:!0,src:"https://www.googletagmanager.com/gtag/js?id=G-10J4H088NL"},{hid:"gtag",innerHTML:`window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-10J4H088NL');`,type:"text/javascript",charset:"utf-8"}],__dangerouslyDisableSanitizersByTagID:{gtm:["innerHTML"],gtag:["innerHTML"]}}),(v,b)=>{const o=r("v-main"),y=r("v-app");return d(),f(y,null,{default:s(()=>[i(o,null,{default:s(()=>[i(Ce)]),_:1})]),_:1})}}};export{Ne as default};
